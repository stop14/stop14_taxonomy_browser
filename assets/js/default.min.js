/*! agile-theme v1.0.0 | (c) 2023 Agile Humanities Agency | MIT License | https://agile.git.beanstalkapp.com/agile-theme-builder-v002.git */
/*!
 * agile-theme v1.0.0
 * A custom Drupal theme for the Dartmouth Digitial History Initiative.
 * (c) 2023 Agile Humanities Agency
 * MIT License
 * https://agile.git.beanstalkapp.com/agile-theme-builder-v002.git
 */
!function(t,a,n){t.fn.extend({makeList:function(a={}){if(this.length>0){var n=t("<ul></ul>").addClass("tb-list");return"string"==typeof a.class&&n.addClass(a.class),this.each((function(a,e){t("<li></li>").html(e).appendTo(n)})),n}return""},taxonomyBrowser:function(){var a=this,n=a.data("endpoint"),e=a.data("initial-route");a.data("topic");function i(n){var e=function(a){var n=!1;return t.ajax({url:a,async:!1,success:function(t){n=t}}),n}(n+"?_format=json"),r=t(function(a){var n=[];return t(a.terms).each((function(a,e){n.push(function(a){const n=a.hasOwnProperty("displayTitle")?a.displayTitle:a.name;return t("<a></a>").addClass("tb-term").attr("data-route",a.childRoute).attr("data-tid",a.tid).html(n)}(e))})),n}(e)).makeList({class:"tb-term-list"}),l=t(function(a){var n=[];return t(a.content).each((function(a,e){n.push(function(a){return t("<a></a>").addClass("tb-content").attr("href",a.href).attr("data-id",a.id).html(a.title)}(e))})),n}(e)).makeList({class:"tb-content-list"});!1!==e&&function(n,e=null){var r=t("<div></div>").addClass("tb-panel").attr("data-panel",a.children().length).html(n),l=t("<header></header>");null!==e&&l.prepend("<div class='tb-group-label'>"+e+"</div>");if(a.children().length-1>-1){var s=a.children().eq(a.children().length-1).find(".tb-group-label").text(),o=t("<a></a>").addClass("tb-back").attr("title","Back to "+s);o.on("click",(function(){var n,e,i,r;n=t(this).closest(".tb-panel").data("panel"),e=a.find(".tb-panel"),i=e.first(),r=parseInt(n),e.each((function(){if(t(this).data("panel")>=r){var a=i.position().left,n=t(this).closest(".tb-track"),e=t(this);n.animate({scrollLeft:a+n.scrollLeft(),duration:200,done:()=>{e.remove()}})}else i=t(this)}))})),l.prepend(o)}r.prepend(l),r.on("click",".tb-term",(function(){var n;n=t(this).closest(".tb-panel").data("panel"),a.find(".tb-panel").each((function(){t(this).data("panel")>n&&t(this).remove()})),i(t(this).data("route")),t(this).closest(".tb-panel").find(".tb-term").removeClass("active"),t(this).addClass("active")})),r.appendTo(a),t(document).trigger("tb-panel-change",{tbrowser:a,panel:r,track:a.parent(".tb-track")})}([...r,...l],e.parent.label)}void 0!==n&&void 0!==e&&i(e)}}),t(document).on("tb-panel-change",(function(a,n){var e=t(n.tbrowser);const i=t(n.track),r=i.innerWidth();var l=e.children().last().position().left;l>=r&&i.animate({scrollLeft:l+i.scrollLeft()},200)})),a.behaviors.initTaxonomyBrowser={attach:function(a,e){n("initialize",".taxonomy-browser",a).forEach((function(a){t(a).taxonomyBrowser()}))}}}(jQuery,Drupal,once);